{% extends "base.html" %}
{% from "macros.html" import render_pizza_card %}

{% block title %}–ú–µ–Ω—é (–ö–∞—Ä—Ç–æ—á–∫–∏) - –ü—ñ—Ü–µ—Ä—ñ—è Oderman{% endblock %}

{% block content %}
<div class="menu-header">
    <h2 class="page-title">–ù–∞—à–µ –º–µ–Ω—é</h2>
    <p class="menu-intro">–û–±–µ—Ä—ñ—Ç—å —Å–≤–æ—é —É–ª—é–±–ª–µ–Ω—É –ø—ñ—Ü—É –∑ –Ω–∞—à–æ–≥–æ –≤–µ–ª–∏–∫–æ–≥–æ –∞—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç—É</p>
    
    <div class="view-toggle">
        <a href="{{ url_for('menu') }}" class="view-btn">üìã –¢–∞–±–ª–∏—Ü—è</a>
        <a href="{{ url_for('menu_cards') }}" class="view-btn active">üÉè –ö–∞—Ä—Ç–æ—á–∫–∏</a>
    </div>
</div>

<div class="menu-categories">
    <button class="category-btn active" data-category="all">–í—Å—ñ –ø—ñ—Ü–∏</button>
    <button class="category-btn" data-category="classic">–ö–ª–∞—Å–∏—á–Ω—ñ</button>
    <button class="category-btn" data-category="premium">–ü—Ä–µ–º—ñ—É–º</button>
    <button class="category-btn" data-category="vegetarian">–í–µ–≥–µ—Ç–∞—Ä—ñ–∞–Ω—Å—å–∫—ñ</button>
</div>

<div class="pizza-cards-container">
    {% for pizza in pizzas %}
    {{ render_pizza_card(pizza) }}
    {% endfor %}
</div>

<div class="cart-summary" id="cartSummary" style="display: none;">
    <h3>–í–∞—à –∫–æ—à–∏–∫</h3>
    <div id="cartItems"></div>
    <div class="cart-total">
        <strong>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: <span id="cartTotal">0</span> –≥—Ä–Ω</strong>
    </div>
</div>

<div class="order-section">
    <div class="order-info">
        <h3>–ì–æ—Ç–æ–≤—ñ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?</h3>
        <p>–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Å—É–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è: 200 –≥—Ä–Ω</p>
        <p>–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –≤—ñ–¥ 500 –≥—Ä–Ω</p>
    </div>
    <button class="order-button" id="orderButton" onclick="window.location.href='{{ url_for('order_form') }}'">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
</div>
{% endblock %}

{% block extra_css %}
<style>
.view-toggle {
    margin: 20px 0;
    text-align: center;
}

.view-btn {
    display: inline-block;
    margin: 0 10px;
    padding: 10px 20px;
    text-decoration: none;
    background: #f8f8f8;
    color: #333;
    border-radius: 25px;
    transition: all 0.3s ease;
}

.view-btn.active,
.view-btn:hover {
    background: #ff6b6b;
    color: white;
}

.pizza-cards-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.pizza-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    transition: transform 0.3s ease;
}

.pizza-card:hover {
    transform: translateY(-5px);
}

.pizza-card-header {
    background: linear-gradient(45deg, #ff6b6b, #feca57);
    color: white;
    padding: 20px;
    text-align: center;
}

.pizza-card-name {
    margin: 0;
    font-size: 1.3rem;
    margin-bottom: 10px;
}

.pizza-card-body {
    padding: 20px;
}

.pizza-card-ingredients {
    color: #666;
    line-height: 1.5;
    margin-bottom: 15px;
}

.pizza-card-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.pizza-card-size {
    font-weight: bold;
    color: #333;
}

.pizza-card-footer {
    padding: 20px;
    background: #f8f9fa;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.pizza-card-price {
    font-size: 1.3rem;
    font-weight: bold;
    color: #27ae60;
}

@media (max-width: 768px) {
    .pizza-cards-container {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    let cart = [];
    const categoryBtns = document.querySelectorAll('.category-btn');
    const pizzaCards = document.querySelectorAll('.pizza-card');
    
    categoryBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const category = this.dataset.category;
            
            categoryBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            pizzaCards.forEach(card => {
                if (category === 'all' || card.dataset.category === category) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    });
    
    const addToCartBtns = document.querySelectorAll('.add-to-cart-btn');
    addToCartBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const pizzaName = this.dataset.pizza;
            const pizzaPrice = parseInt(this.dataset.price);
            
            const existingItem = cart.find(item => item.name === pizzaName);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    name: pizzaName,
                    price: pizzaPrice,
                    quantity: 1
                });
            }
            
            updateCartDisplay();
            this.textContent = '–î–æ–¥–∞–Ω–æ!';
            setTimeout(() => {
                this.textContent = '–î–æ–¥–∞—Ç–∏ –¥–æ –∫–æ—à–∏–∫–∞';
            }, 1000);
        });
    });
    
    function updateCartDisplay() {
        const cartSummary = document.getElementById('cartSummary');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        
        if (cart.length === 0) {
            cartSummary.style.display = 'none';
            return;
        }
        
        cartSummary.style.display = 'block';
        
        let itemsHtml = '';
        let total = 0;
        
        cart.forEach(item => {
            itemsHtml += `<div class="cart-item">
                ${item.name} x${item.quantity} - ${item.price * item.quantity} –≥—Ä–Ω
            </div>`;
            total += item.price * item.quantity;
        });
        
        cartItems.innerHTML = itemsHtml;
        cartTotal.textContent = total;
    }
});
</script>
{% endblock %}

{% extends "base.html" %}

{% block title %}–ú–µ–Ω—é - –ü—ñ—Ü–µ—Ä—ñ—è Oderman{% endblock %}

{% block content %}
<div class="menu-header">
    <h2 class="page-title">–ù–∞—à–µ –º–µ–Ω—é</h2>
    <p class="menu-intro">–û–±–µ—Ä—ñ—Ç—å —Å–≤–æ—é —É–ª—é–±–ª–µ–Ω—É –ø—ñ—Ü—É –∑ –Ω–∞—à–æ–≥–æ –≤–µ–ª–∏–∫–æ–≥–æ –∞—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç—É</p>
</div>

<div class="menu-categories">
    <button class="category-btn active" data-category="all">–í—Å—ñ –ø—ñ—Ü–∏</button>
    <button class="category-btn" data-category="classic">–ö–ª–∞—Å–∏—á–Ω—ñ</button>
    <button class="category-btn" data-category="premium">–ü—Ä–µ–º—ñ—É–º</button>
    <button class="category-btn" data-category="vegetarian">–í–µ–≥–µ—Ç–∞—Ä—ñ–∞–Ω—Å—å–∫—ñ</button>
</div>

<div class="menu-table-container">
    <table class="menu-table">
        <thead>
            <tr>
                <th>–ù–∞–∑–≤–∞ –ø—ñ—Ü–∏</th>
                <th>–û–ø–∏—Å —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤</th>
                <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
                <th>–†–æ–∑–º—ñ—Ä</th>
                <th>–¶—ñ–Ω–∞</th>
                <th>–î—ñ—ó</th>
            </tr>
        </thead>
        <tbody>
            {% for pizza in pizzas %}
            <tr class="pizza-row" data-category="{{ pizza.category }}">
                <td class="pizza-name">
                    <div class="pizza-info">
                        <strong>{{ pizza.name }}</strong>
                        {% if pizza.popular %}
                        <span class="popular-badge">üî• –ü–æ–ø—É–ª—è—Ä–Ω–∞</span>
                        {% endif %}
                    </div>
                </td>
                <td class="pizza-ingredients">{{ pizza.ingredients }}</td>
                <td class="pizza-category">
                    <span class="category-tag category-{{ pizza.category }}">
                        {{ pizza.category_display }}
                    </span>
                </td>
                <td class="pizza-size">{{ pizza.size }}</td>
                <td class="pizza-price">{{ pizza.price }}</td>
                <td class="pizza-actions">
                    <button class="add-to-cart-btn" data-pizza="{{ pizza.name }}" data-price="{{ pizza.price }}">
                        –î–æ–¥–∞—Ç–∏ –¥–æ –∫–æ—à–∏–∫–∞
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="cart-summary" id="cartSummary" style="display: none;">
    <h3>–í–∞—à –∫–æ—à–∏–∫</h3>
    <div id="cartItems"></div>
    <div class="cart-total">
        <strong>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: <span id="cartTotal">0</span> –≥—Ä–Ω</strong>
    </div>
</div>

<div class="order-section">
    <div class="order-info">
        <h3>–ì–æ—Ç–æ–≤—ñ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?</h3>
        <p>–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Å—É–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è: 200 –≥—Ä–Ω</p>
        <p>–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –≤—ñ–¥ 500 –≥—Ä–Ω</p>
    </div>
    <button class="order-button" id="orderButton" onclick="window.location.href='{{ url_for('order_form') }}'">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    let cart = [];
    
    const categoryBtns = document.querySelectorAll('.category-btn');
    const pizzaRows = document.querySelectorAll('.pizza-row');
    
    categoryBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const category = this.dataset.category;
            
            categoryBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            pizzaRows.forEach(row => {
                if (category === 'all' || row.dataset.category === category) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });
    });
    const addToCartBtns = document.querySelectorAll('.add-to-cart-btn');
    addToCartBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const pizzaName = this.dataset.pizza;
            const pizzaPrice = parseInt(this.dataset.price);
            const existingItem = cart.find(item => item.name === pizzaName);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    name: pizzaName,
                    price: pizzaPrice,
                    quantity: 1
                });
            }
            
            updateCartDisplay();
            this.textContent = '–î–æ–¥–∞–Ω–æ!';
            setTimeout(() => {
                this.textContent = '–î–æ–¥–∞—Ç–∏ –¥–æ –∫–æ—à–∏–∫–∞';
            }, 1000);
        });
    });
    
    function updateCartDisplay() {
        const cartSummary = document.getElementById('cartSummary');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        
        if (cart.length === 0) {
            cartSummary.style.display = 'none';
            return;
        }
        
        cartSummary.style.display = 'block';
        
        let itemsHtml = '';
        let total = 0;
        
        cart.forEach(item => {
            itemsHtml += `<div class="cart-item">
                ${item.name} x${item.quantity} - ${item.price * item.quantity} –≥—Ä–Ω
            </div>`;
            total += item.price * item.quantity;
        });
        
        cartItems.innerHTML = itemsHtml;
        cartTotal.textContent = total;
    }
});
</script>
{% endblock %}
